# 미들웨어(app.요청상태((req, res, next) => { ... next(); }))
- app.use() : 해당 요청에 공통적인 코드를 실행해주고 싶을 때 사용함
+ 메시지 부분은 비워두면 모든 요청에 공통적인 코드 실행, 해당 메시지를 적어주면 그 메시지에 해당하는 요청에만 코드 실행됨
+ 이 부분은 실행되는데 라우터가 실행이 안됨 => next를 인수에 넣어주어야함
- 미들웨어는 해당 요청상태 속에 여러개를 넣어주어도 됨
+ ex> ((req, res, next) => { ... next(); }, (req, res, next) => { ... next(); }, (req, res, next) => { ... next(); }, ... )

# [미들웨어]의 [값]을 [다른] [미들웨어]로 [보내주고] [싶을] [때]
+ req.session.data = 'zerocho 비번' -> req.session.data로 하면 됨
  (값이 계속 브라우저에 저장되어 있음)
+ [req.data][=]['비번'] -> [req.data]로 하면 됨 (일회성)

# next() : 해당 함수 들어왔을 때 처리하고 다음 함수로 이동하게 해줌
- next() : 바로 다음 미들웨어로 이동하게 됨
- next(인수) : 바로 에러처리 미들웨어로 들어가게 됨
- next('route') : 바로 다음 라우터로 넘어감

# 라우터 : 메시지와 주소가 있는 요청들
- get, post, put, delete, patch 등

# app.get('*') => 모든 페이지를 다 여기서 요청 받겠다는 말

# 미들웨어로 에러처리 하는 법
- 에러처리 미들웨어시 매개변수가 4개여야하는 조건이 충족되어야함
- ex> ((err, req, res, next) => {})

# 서버 관련 작성 순서
1. app 만들기
2. app 관련된 설정 해줌
3. 공통 미들웨어 넣어줌
4. 라우터 넣어줌(범위가 넓은 애들 뒤로)
5. 에러 미들웨어 넣어줌

# 미들웨어 확장법(미들웨어 안에 미들웨어 사용법)
## 미들웨어 종류와 함께 사용할 때 유용함(특히 남의 미들웨어 사용 시)
- ex> morgan, static, cookieParser, session, express.json, express.urlencoded 등
- 형식 : (req,res,next) => { // 로그인한 사용자에게만 이미지 보여줄 때
    if(req.session.id){
        express.static(__dirname, 'pikachu.png')(req, res, next);
    } else { next(); }
  }

### [ 미들웨어 종류 ] ###
#### 아래 종류가 (req,res,next)=>{} 형태로 된 하나의 미들웨어라고 보면 됨
# static
- 정적파일을 url을 통해서 찾아서 보여주고자 할 때 사용함(index.html, index.png 등 사진이나 페이지를 그냥 보여주려고 할 때)
- static의 위치
+ 여기서 파일을 찾으면 아래가 실행이 안됨(body-parser보단 위에 있음)
+ 로그인 한 사람한테만 파일, 그림 보여주거나 할 때에는 cookieParser 아래 둠
- REST 서버시 readFile했던 것 정적 파일 보내주는 부분이 static으로 빠졌다고 보면 됨
- 파일을 찾으면 next 안함, 못찾으면 next 해서 다음을 실행함
- 보통 static은 morgan바로 아래에서 함
- ex> app.use('요청 경로', express.static('실제 경로'));
+ app.use('/', express.static(__dirname, 'public'));
+ localhost:3000/zerocho.html          프로젝트폴더/public/zerocho.html
+ localhost:3000/hello.html            프로젝트폴더/public/hello.html
+ ㄴ 보안에 좋음(서버가 어떤 구조로 되어있는지 외부에서 알 수 없음)

# express-session
- session() = const session = {}; 같은 의미
- req.session.key이름 을 하면
+ session[uniqueInt] = { name, expires, };
+ ㄴ uniqueInt처럼 사용자 아이디를 주지 않아도 현재 요청한 사용자의 session을 자동으로 불러오게 됨 구분을 express-session에서 해줌
- express-session 옵션
+ resave: false, (요청이 왔을 때 세션에 수정사항이 생기지 않아도 다시 저장할지 여부)
+ saveUninitialized: false, (세션에 저장할 내역이 없더라도 저장할지)
+ secret: 'zerochopassword', 
  (쿠키암호화, 최대한 cookieparser 암호와 같게)
+ cookie: { httpOnly: true, } 
  (앞에 s%3A가 붙은 후 암호화되어 프런트에 전송됨)
+ name: 'connect.sid', (기본적으로 connect.sid로 되어있음) => secret으로 암호를 주었기에 읽을 수 없게 표시가 됨
